<script type="module" defer>
  function markAsExternalLink(link) {
    link.setAttribute("target", "_blank");
    link.setAttribute("rel", "noopener");
    let svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "25");
    svg.setAttribute("height", "25");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "currentColor");
    svg.setAttribute("class", "h-[1em] w-[1em] inline align-middle ml-[0.25em] mb-[0.25em]");
    svg.setAttributeNS(
      "http://www.w3.org/2000/xmlns/",
      "xmlns:xlink",
      "http://www.w3.org/1999/xlink"
    );
    svg.innerHTML = `
      <title>Opens in new tab</title>
      <path d="
        M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3
        M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21
        H19A2,2 0 0,0 21,19V12H19V19Z
        ">
      </path>
    `
    link.appendChild(svg);
  }
  let domain = window.location.hostname;
  let proseExtLinks = document.querySelectorAll(
    `main .prose a[href^="http"]:not([href*="${domain}"])`
  );
  for (let link of proseExtLinks) {
    markAsExternalLink(link);
  }
  let footerExtLinks = document.querySelectorAll(
    `[data-possible-external-link] a[href^="http"]:not([href*="${domain}"])`
  );
  for (let link of footerExtLinks) {
    markAsExternalLink(link);
  }
</script>
